name: LinPEAS
authors:
  - name: Anthony Rose
    handle: Cx01N
    link: https://twitter.com/Cx01N_
  - name: Werebug
    handle: ''
    link: https://werebug.com
description: |
  Executes LinPEAS (Linux Privilege Escalation Awesome Script) to perform
  comprehensive privilege escalation reconnaissance on Linux, Unix, and
  macOS systems. Scans for common privilege escalation vectors including
  SUID binaries, writable files, cron jobs, environment variables,
  kernel exploits, and misconfigured services. Provides detailed output
  of potential attack paths and security misconfigurations that could
  lead to privilege escalation.
  Downloads the latest version of linpeas.sh from GitHub.
software: ''
tactics: []
techniques:
  - T1046
background: true
output_extension:
needs_admin: false
opsec_safe: true
language: python
min_language_version: '3'
comments:
  - https://github.com/carlospolop/PEASS-ng/tree/master/linPEAS
options:
  - name: Agent
    description: Agent to run on.
    required: true
    value: ''
script: |
  script_input = r'''
  %s
  '''
  try:
    # Use subprocess to run the shell script and capture the output
    process = subprocess.Popen('/bin/sh',
                               stdin=subprocess.PIPE,
                               stdout=subprocess.PIPE,
                               stderr=subprocess.PIPE)
    stdout, stderr = process.communicate(input=script_input.encode())

    # Print the output
    print(stdout.decode('latin-1'))
  except Exception as e:
    print(e)
advanced:
  custom_generate: true
